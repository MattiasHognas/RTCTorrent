var RtcTorrent;(function(n){"use strict";var t=function(){function t(n,t,i,r){this.fs=null,this.client=r,this.id=ko.observable(n),this.name=ko.observable(t),this.size=ko.observable(i),this.peers=ko.observableArray([]),this.files=ko.observableArray([]),this.readyToServe=ko.observable(!1),this.loadFiles()}return t.prototype.quotaError=function(n){var t="";switch(n.code){case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}console.log("Error: "+t)},t.prototype.loadFiles=function(){var t=this;t.client.configuration.requestFileSystem(window.PERSISTENT,t.size,function(i){t.fs=i,t.fs.root.getDirectory(t.id(),{},function(i){var u=i.createReader(),r=function(){u.readEntries(function(i){var f,u;if(i.length){for(f=0;f<i.length;f++)u=i[f],u.isDirectory?console.log("Directory: "+u.fullPath):u.isFile&&(console.log("File: "+u.fullPath),t.files.push(new n.FileContent(t,u)));r()}else t.readyToServe(!0)},function(n){console.log("readEntries error",n)})};r()},function(n){console.log("getDictionary error",n)})},t.quotaError)},t.prototype.sendMessage=function(n,t){this.findPeer(t).channel.send(n)},t.prototype.createPeer=function(t){var i=new n.Peer(t,this);this.peers.push(i)},t.prototype.findPeer=function(n){return ko.utils.arrayFirst(this.peers(),function(t){return n===t.id()})},t.prototype.removePeer=function(n){var t=ko.utils.arrayFirst(this.peers(),function(t){return n===t.id()});t&&this.peers.remove(t)},t}();n.Torrent=t})(RtcTorrent||(RtcTorrent={}))