var observableArray,RtcTorrent;(function(n){"use strict";var t=function(){function t(n,t){this.fs=null,this.client=n,this.trackerTorrent=t,this.peers=ko.observableArray([]),this.files=ko.observableArray([]),this.readyToServe=ko.observable(!1),this.loadFiles(t)}return t.prototype.quotaError=function(n){var t="";switch(n.code){case 10:t="INVALID_STATE_ERR";break;case FileError.QUOTA_EXCEEDED_ERR:t="QUOTA_EXCEEDED_ERR";break;case FileError.NOT_FOUND_ERR:t="NOT_FOUND_ERR";break;case FileError.SECURITY_ERR:t="SECURITY_ERR";break;case FileError.INVALID_MODIFICATION_ERR:t="INVALID_MODIFICATION_ERR";break;case FileError.INVALID_STATE_ERR:t="INVALID_STATE_ERR";break;default:t="Unknown Error"}console.log("Error: "+t,n)},t.prototype.loadFiles=function(t){var i=this;i.client.configuration.requestQuota(window.PERSISTENT,t.size(),function(r){console.log("Quota is available. Quota size: "+r),i.client.configuration.requestFileSystem(window.PERSISTENT,i.trackerTorrent.size(),function(r){i.fs=r,i.fs.root.getDirectory(t.id(),{create:!0},function(r){for(var f=r.createReader(),u=0;u<t.files().length;u++)i.files.push(new n.FileContent(i,f,t.id()+"/"+t.files()[u].fullPath(),t.files()[u].size(),t.files()[u].pieces()))},function(n){console.log("getDictionary error",n)})},i.quotaError)},i.quotaError)},t.prototype.sendMessage=function(n,t){this.findPeer(t).channel.send(n)},t.prototype.createPeer=function(t){var i=new n.Peer(t,this);this.peers.push(i)},t.prototype.findPeer=function(n){return ko.utils.arrayFirst(this.peers(),function(t){return n===t.id()})},t.prototype.removePeer=function(n){var t=ko.utils.arrayFirst(this.peers(),function(t){return n===t.id()});t&&this.peers.remove(t)},t}();n.Torrent=t})(RtcTorrent||(RtcTorrent={}))